var DataBind=function(e){"use strict";return e.Binder=function(e,t){function a(e){var t=l.querySelectorAll('[data-foreach$="in '+e+'"]');v(t,e),o(t);var a=l.querySelectorAll('[data-bind="'+e+'"]');b(a);var n=l.querySelectorAll('[data-class="'+e+'"]');u(n);var r=l.querySelectorAll('[data-class^="'+e+'("]');u(r)}function n(e,t){for(var a=[].slice.call(e),n=0;n<a.length;n++)for(var r=0;r<t.length;r++)a[n]===t[r]&&a.splice(n,1);return a}var r=t||window.document,l=r.querySelector("[data-scope="+e.scope+"]"),c={},i={};e.setValueChanged(a);var o=function(e){for(var t=0;t<e.length;t++){var a=e[t].querySelectorAll("[data-bind]");b(a);var n=e[t].querySelectorAll("[data-class]");u(n);var r=e[t].querySelectorAll("[data-click]");p(r);var c=l.querySelectorAll("[data-enter]");f(c)}},u=function(e){for(var t=0;t<e.length;t++)d(e[t])},d=function(t){var a=t.getAttribute("data-class"),n=c[a];n&&t.classList.remove(n);var r=e.get(a);c[a]=r,r&&t.classList.add(r)},s=function(){var e=l.querySelectorAll("[data-foreach]"),t=l.querySelectorAll("[data-foreach] [data-foreach]"),a=n(e,t);g(a),v(a);var r=l.querySelectorAll("[data-bind]");b(r);var c=l.querySelectorAll("[data-class]");u(c);var i=l.querySelectorAll("[data-click]");p(i);var o=l.querySelectorAll("[data-enter]");f(o)},f=function(e){for(var t=0;t<e.length;t++)h(e[t])},h=function(t){var a=t.getAttribute("data-enter");t.onkeydown=function(t){13===t.which&&e.get(a)}},p=function(e){for(var t=0;t<e.length;t++)A(e[t])},g=function(e){for(var t=0;t<e.length;t++){for(var a=[],n=0;n<e[t].children.length;n++)a.push(e[t].children[n].cloneNode(!0));var r=e[t].getAttribute("data-foreach"),l=r.split(" in ");i[r]={template:a,items:l[1].trim(),item:l[0].trim()}}},v=function(t){for(var a=0;a<t.length;a++){m(t[a]);for(var n=t[a].getAttribute("data-foreach"),r=i[n],l=e.get(r.items),c=0;c<l.length();c++)for(var o=0;o<r.template.length;o++){var u=r.template[o].cloneNode(!0);t[a].appendChild(u),y(u,"data-bind",r,c),y(u,"data-class",r,c),y(u,"data-foreach",r,c)}}},m=function(e){for(;e.lastChild;)e.removeChild(e.lastChild)},y=function(e,t,a,n){var r=function(e){return e.replace(a.item,a.items+"["+n+"]")};if(e.hasAttribute(t)){var l=e.getAttribute(t),c=l.replace(new RegExp("^"+a.item+"(?=[.]|$)"),a.items+"["+n+"]").replace(new RegExp("[(,] *"+a.item+" *(?=[,)])","g"),r).replace(new RegExp(" in "+a.item+"$")," in "+a.items+"["+n+"]");e.setAttribute(t,c),"data-foreach"===t&&(g([e]),v([e]))}for(var i=0;i<e.children.length;i++)y(e.children[i],t,a,n)},A=function(t){var a=t.getAttribute("data-click");t.onclick=function(){e.get(a)}},b=function(e){for(var t=0;t<e.length;t++)x(e[t])},x=function(t){var a=t.getAttribute("data-bind"),n=e.get(a);void 0===n?e.attr(a,""):"checkbox"===t.type?(t.checked=n,t.onclick=function(){e.attr(a,t.checked)}):"radio"===t.type?(t.checked=n===t.value,t.onclick=function(){e.attr(a,t.value)}):"select"===t.tagName.toLowerCase()?(t.value=n,t.onchange=function(){e.attr(a,t.value)}):"text"===t.type||"textarea"===t.type?(t.value!==n&&(t.value=n),t.oninput=function(){e.attr(a,t.value)}):t.innerHTML=n};return{bind:s}},e}(DataBind||{}),DataBind=function(dataBind){"use strict";return dataBind.Model=function(scope){function tokenize(e){for(var t=e.split("."),a=0;a<t.length;a++){var n=t[a].indexOf("][");if(n>=0){var r=t[a].substring(0,n+1),l=t[a].substring(n+1);t.splice(a,1),t.splice(a,0,r),t.splice(a+1,0,l)}}return t}var attrs={},dependsOn={},valueChanged=function(){},getArrayIndexerMatch=function(e){var t=/\[([^\]]+)\]/;return t.exec(e)},fireValueChangedForAll=function(e){e.forEach(function(e){fireValueChangedForAllDependencies(e)})},attr=function(name,value,object,fullName,changedCollections){fullName=fullName||name,changedCollections=changedCollections||[];var dotPieces=tokenize(name),rest=dotPieces.slice(1,dotPieces.length).join("."),arrayIndexer=getArrayIndexerMatch(dotPieces[0]);if(null!==arrayIndexer){var prop=dotPieces[0].substring(0,arrayIndexer.index),index=getIndex(arrayIndexer[1]);""!==prop&&changedCollections.push(prop),void 0!==object?""===prop?1===dotPieces.length?(object[index]=value,fireValueChangedForAllDependencies(fullName),fireValueChangedForAll(changedCollections)):attr(rest,value,object[index],fullName,changedCollections):attr(rest,value,eval("object."+prop)[index],fullName,changedCollections):1===dotPieces.length?(attrs[prop][index]=value,fireValueChangedForAllDependencies(fullName),fireValueChangedForAll(changedCollections)):attr(rest,value,attrs[prop][index],fullName,changedCollections)}else void 0!==object?1===dotPieces.length?(object[dotPieces[0]]=value,fireValueChangedForAllDependencies(fullName),fireValueChangedForAll(changedCollections)):attr(rest,value,eval("object."+dotPieces[0]),fullName):1===dotPieces.length?(attrs[name]=value,fireValueChangedForAllDependencies(name)):(void 0===attrs[dotPieces[0]]&&(attrs[dotPieces[0]]={}),attr(rest,value,attrs[dotPieces[0]],fullName))},parseFunctionCall=function(e){var t=[],a=e,n=/[(][^)]*[)]/,r=n.exec(e);if(null!==r){a=e.substring(0,r.index);var l=r[0].replace("(","").replace(")",""),c=l.length>0?l.split(","):[];c.forEach(function(e){t.push(get.call(this,e.trim()))})}return{name:a,args:t,isMatch:null!==r}},get=function(name,object,fullName){if(fullName=fullName||name,/^\d+$/.test(name))return parseInt(name);var dotPieces=tokenize(name),rest=dotPieces.slice(1,dotPieces.length).join("."),parseFuncResult=parseFunctionCall(dotPieces[0]);if(!parseFuncResult.isMatch){var arrayIndexer=getArrayIndexerMatch(dotPieces[0]);if(null!==arrayIndexer){var prop=dotPieces[0].substring(0,arrayIndexer.index),index=getIndex(arrayIndexer[1]);return void 0!==object?""===prop?get.call(this,rest,object[index],fullName):get.call(this,rest,eval("object."+prop)[index],fullName):get.call(this,rest,attrs[prop][index],fullName)}}if(void 0!==object)return""===dotPieces[0]?checkWrapArray(fullName,object):get.call(this,rest,eval("object."+dotPieces[0]),fullName);if(1===dotPieces.length)return"function"==typeof attrs[parseFuncResult.name]?attrs[parseFuncResult.name].apply(this,parseFuncResult.args):checkWrapArray(name,attrs[name]);var thisObject="function"==typeof attrs[parseFuncResult.name]?attrs[parseFuncResult.name].apply(this,parseFuncResult.args):attrs[dotPieces[0]];return get.call(this,rest,thisObject,fullName)},checkWrapArray=function(e,t){return Array.isArray(t)?new DataBind.Collection(e,t,fireValueChangedForAllDependencies):t},fireValueChangedForAllDependencies=function(e){valueChanged(e),dependsOn.hasOwnProperty(e)&&dependsOn[e].forEach(function(e){fireValueChangedForAllDependencies(e)})},computed=function(e,t,a){a&&a.forEach(function(t){addDependency(e,t)});for(var n=/this\.get\(['"]([^'"]+)['"]\)/g,r=n.exec(t.toString());null!=r;)addDependency(e,r[1]),r=n.exec(t.toString());attrs[e]=t},action=function(e,t){attrs[e]=t},addDependency=function(e,t){dependsOn[t]=dependsOn[t]||[],dependsOn[t].push(e)},setValueChanged=function(e){valueChanged=e},getIndex=function(e){var t=/^\d+$/;return t.test(e)?parseInt(e):attrs[e]};return{attr:attr,get:get,computed:computed,action:action,scope:scope,setValueChanged:setValueChanged}},dataBind}(DataBind||{}),DataBind=function(e){"use strict";return e.Collection=function(e,t,a){var n=function(n){t.push(n),a(e)},r=function(){t.pop(),a(e)},l=function(n){t.forEach(function(e){n(e)}),a(e)},c=function(){t.length=0,a(e)};return{push:n,pop:r,value:t,length:function(){return t.length},forEach:l,clear:c}},e}(DataBind||{});